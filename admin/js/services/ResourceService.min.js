app.service("ResourceService",["$localStorage","$http","URLS","TaskService","ImageLoader",function(c,f,b,e,d){var a=this;a.names=["animations","tilesets"];this.loadResources=function(g){if(!c.resources){c.resources={}}a.load(0,g)};this.load=function(i,h){if(i<a.names.length!==undefined){var g=a.names[i];if(!c.resources[g]){f({method:"GET",url:b.BASE_URL+g+"/list"}).then(function(j){if(j.data.success){c.resources[g]=j.data[g]}})}else{a.load(i+1,h)}}else{if(typeof h==="function"){h()}}};this.loadPage=function(h,g,i){a.load(function(){var j=c.resources.animations.slice((h-1)*g,(g*h));i(j)})};this.remove=function(h){if(c.resources.animations[h]!==undefined){var i=c.resources.animations[h];c.resources.animations.splice(h,1);var g={data:{id:i._id},date:new Date(),action:"REMOVE_ANIMATION_RESOURCE",priority:1};e.add(g)}};this.add=function(i,j,g){var h=new FormData();h.append("file",i.file);Object.keys(i.fields).forEach(function(k){h.append(k,i.fields[k])});f({method:"POST",url:b.BASE_URL+"animations/upload",data:h,withCredentials:true,transformRequest:angular.identity,headers:{"Content-Type":undefined}}).then(function(k){if(k.data.success){c.resources.animations.unshift(k.data.animation);j()}else{g()}},function(){g()})}}]);